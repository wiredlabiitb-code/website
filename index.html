<!DOCTYPE html>
<html>
<head>
  <title>Lab Members</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    .grid { display:flex; flex-wrap:wrap; gap:20px; }
    .card {
      width:250px;
      padding:15px;
      border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      background:white;
      transition: transform 0.2s ease;
    }
    .card:hover { transform: translateY(-4px); }
    .photo {
      width:100%;
      aspect-ratio:1/1;
      object-fit:cover;
      border-radius:50%;
    }
    .role { font-weight:bold; color:#444; margin-bottom:6px; }

    /* Skeleton loading */
    .skeleton .ph {
      width:100%;
      aspect-ratio:1/1;
      border-radius:50%;
      background:#eee;
    }
    .skeleton .line {
      height:12px;
      background:#eee;
      margin:10px 0;
      border-radius:6px;
    }
    .w60{width:60%} .w40{width:40%}
  </style>
</head>

<body>

<h2>Active Members</h2>
<div id="active" class="grid">
  <div class="card skeleton">
    <div class="ph"></div>
    <div class="line w60"></div>
    <div class="line w40"></div>
  </div>
</div>

<div id="alumni-section" style="display:none;">
  <h2>Alumni</h2>
  <div id="alumni" class="grid"></div>
</div>

<script>
(async function () {
  try {
    const res = await fetch("https://raw.githubusercontent.com/wiredlabiitb-code/website/main/members.json");
    if (!res.ok) throw new Error("JSON not found");

    const data = await res.json();
    if (!data.active) throw new Error("Invalid JSON");

    const activeDiv = document.getElementById("active");
    const alumniDiv = document.getElementById("alumni");
    const alumniSection = document.getElementById("alumni-section");

    function makeCard(m) {
      const card = document.createElement("div");
      card.className = "card";

      const img = document.createElement("img");
      img.className = "photo";
      img.loading = "lazy";
      img.decoding = "async";
      img.src = m.photo || "default-profile.png";
      card.appendChild(img);

      const name = document.createElement("h3");
      name.textContent = m["Full Name"] || "";
      card.appendChild(name);

      if (m["Role"]) {
        const role = document.createElement("p");
        role.className = "role";
        role.textContent = m["Role"];
        card.appendChild(role);
      }

      if (m["Research Interests"]) {
        const p = document.createElement("p");
        p.innerHTML = "<strong>Research:</strong> " + m["Research Interests"];
        card.appendChild(p);
      }

      if (m["Hobbies"]) {
        const p = document.createElement("p");
        p.innerHTML = "<strong>Hobbies:</strong> " + m["Hobbies"];
        card.appendChild(p);
      }

      if (m["Personal Website"] && m["Personal Website"].startsWith("http")) {
        const a = document.createElement("a");
        a.href = m["Personal Website"];
        a.target = "_blank";
        a.textContent = "Website";
        card.appendChild(a);
      }

      return card;
    }

    // Active
    activeDiv.innerHTML = "";
    const frag = document.createDocumentFragment();
    (data.active || []).forEach(m => frag.appendChild(makeCard(m)));
    activeDiv.appendChild(frag);

    // Alumni
    if (data.alumni && data.alumni.length > 0) {
      alumniSection.style.display = "block";
      alumniDiv.innerHTML = "";
      const frag2 = document.createDocumentFragment();
      data.alumni.forEach(m => frag2.appendChild(makeCard(m)));
      alumniDiv.appendChild(frag2);
    }

    document.querySelectorAll(".skeleton").forEach(e => e.remove());

  } catch (err) {
    console.error("Load error:", err);
    document.getElementById("active").innerHTML =
      "<p style='color:red'>Error loading members.</p>";
  }
})();
</script>
  
</body>
</html>
